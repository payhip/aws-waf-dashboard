{
  "index_patterns": ["awswaf*"],
  "template": {
    "settings": {
      "index": {
        "number_of_shards": "1",
        "default_pipeline": "extract_true_client_ip"
      }
    },
    "mappings": {
      "properties": {
        "@timestamp": { "type": "date" },
        "timestamp": { "type": "date" },
        "client": { 
          "properties": { 
            "ip": { "type": "ip" } 
          } 
        },
        "true_client_ip": { "type": "keyword" },
        "cloudflare": { 
          "properties": { 
            "country": { "type": "keyword" } 
          } 
        },
        "real_country_code": { "type": "keyword" },
        "action": {
          "type": "keyword"
        },
        "httpRequest": {
          "properties": {
            "clientIp": { "type": "ip" },
            "headers": {
              "properties": {
                "name": { "type": "keyword" },
                "value": { "type": "keyword" }
              }
            }
          }
        }
      }
    }
  },
  "priority": 400
}
